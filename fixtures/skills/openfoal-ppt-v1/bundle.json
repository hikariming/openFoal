{
  "bundleId": "bundle_openfoal_ppt_v1",
  "name": "openfoal-ppt-v1-bundle",
  "items": [
    {
      "skillId": "openfoal-ppt-v1",
      "source": "daymade/claude-code-skills",
      "sourceType": "bundle",
      "path": "ppt-creator",
      "license": "allow",
      "tags": [
        "ppt",
        "slides",
        "presentation",
        "node"
      ],
      "artifactVersion": "v1",
      "entrySkillPath": "SKILL.md",
      "files": [
        {
          "path": "SKILL.md",
          "content": "---\nname: openfoal-ppt-v1\ndescription: Generate a real PPTX file with Node + PptxGenJS from JSON args. Always produce both .pptx and .meta.json outputs.\nsource: daymade/claude-code-skills (adapted for OpenFoal)\nlicense: MIT\n---\n\n# OpenFoal PPT V1 Skill\n\n## Purpose\nGenerate a strict `.pptx` artifact (not markdown fallback).\n\n## Invocation\nUse this skill through:\n\n- `/skill:openfoal-ppt-v1 {\"title\":\"...\",\"slides\":8,\"lang\":\"zh-CN\",\"out\":\"./.openfoal/output/demo.pptx\"}`\n\n## Args Contract\nRead JSON from the `[Skill Args]` section appended to the input. Parse exactly one JSON object.\n\n`PptSkillArgs` fields:\n\n- `title: string` (required, fallback `OpenFoal Deck`)\n- `slides: number` (required range `3-30`, fallback `8`)\n- `lang: \"zh-CN\" | \"en-US\"` (fallback `zh-CN`)\n- `out: string` (required, fallback `./.openfoal/output/demo.pptx`)\n- `theme?: string` (optional)\n\n## Non-Negotiable Rules\n\n1. Always generate real `.pptx` using Node + `pptxgenjs`.\n2. Always generate `${out}.meta.json`.\n3. Never return markdown as final artifact.\n4. Do not ask follow-up questions when args are present.\n5. Use OpenFoal tools only (`file.write`, `bash.exec`, optional `file.read` for verify).\n\n## Mandatory Workflow\n\n1. Parse and normalize args.\n2. Write generator script to `./.openfoal/output/.tmp/openfoal-ppt-v1-generate.mjs` using `file.write`.\n3. Write normalized args to `./.openfoal/output/.tmp/openfoal-ppt-v1-args.json` using `file.write`.\n4. Execute generator with `bash.exec`:\n   - `node ./.openfoal/output/.tmp/openfoal-ppt-v1-generate.mjs ./.openfoal/output/.tmp/openfoal-ppt-v1-args.json`\n5. Verify outputs with `bash.exec`:\n   - `ls -l <out> <out>.meta.json`\n6. Return a short result including `out`, `slideCount`, and checksum from meta file.\n\n## Generator Script Template\n\nWrite this exact script body (replace only if bug fix is required):\n\n```js\nimport fs from \"node:fs/promises\";\nimport path from \"node:path\";\nimport { createHash } from \"node:crypto\";\nimport PptxGenJS from \"pptxgenjs\";\n\nconst argsFile = process.argv[2];\nif (!argsFile) {\n  throw new Error(\"args file is required\");\n}\n\nconst raw = JSON.parse(await fs.readFile(argsFile, \"utf8\"));\nconst title = typeof raw.title === \"string\" && raw.title.trim().length > 0 ? raw.title.trim() : \"OpenFoal Deck\";\nconst lang = raw.lang === \"en-US\" ? \"en-US\" : \"zh-CN\";\nconst slides = Number.isFinite(Number(raw.slides)) ? Math.trunc(Number(raw.slides)) : 8;\nconst slideCount = Math.min(30, Math.max(3, slides));\nconst out = typeof raw.out === \"string\" && raw.out.trim().length > 0 ? raw.out.trim() : \"./.openfoal/output/demo.pptx\";\nconst theme = typeof raw.theme === \"string\" ? raw.theme.trim() : \"\";\n\nconst cwd = path.resolve(process.cwd());\nconst outAbs = path.resolve(cwd, out);\nif (!(outAbs === cwd || outAbs.startsWith(`${cwd}${path.sep}`))) {\n  throw new Error(`out path escapes workspace: ${out}`);\n}\n\nawait fs.mkdir(path.dirname(outAbs), { recursive: true });\n\nconst pptx = new PptxGenJS();\npptx.layout = \"LAYOUT_WIDE\";\npptx.author = \"OpenFoal\";\npptx.company = \"OpenFoal\";\npptx.subject = \"openfoal-ppt-v1\";\npptx.title = title;\n\nconst palette = theme === \"business\"\n  ? { bg: \"0F172A\", fg: \"FFFFFF\", accent: \"38BDF8\" }\n  : { bg: \"1F2937\", fg: \"FFFFFF\", accent: \"60A5FA\" };\n\nconst titleSlide = pptx.addSlide();\ntitleSlide.background = { color: palette.bg };\ntitleSlide.addText(title, {\n  x: 0.7,\n  y: 1.4,\n  w: 11.8,\n  h: 1.1,\n  fontFace: \"Calibri\",\n  fontSize: 38,\n  bold: true,\n  color: palette.fg,\n  align: \"left\"\n});\nconst subtitle = lang === \"en-US\" ? \"Generated by openfoal-ppt-v1\" : \"由 openfoal-ppt-v1 自动生成\";\ntitleSlide.addText(subtitle, {\n  x: 0.7,\n  y: 2.7,\n  w: 11.4,\n  h: 0.6,\n  fontFace: \"Calibri\",\n  fontSize: 16,\n  color: \"CBD5E1\"\n});\n\ntitleSlide.addShape(pptx.ShapeType.line, {\n  x: 0.7,\n  y: 3.45,\n  w: 3.8,\n  h: 0,\n  line: { color: palette.accent, pt: 1.5 }\n});\n\nfor (let i = 2; i <= slideCount; i += 1) {\n  const slide = pptx.addSlide();\n  slide.background = { color: \"FFFFFF\" };\n  const sectionTitle = lang === \"en-US\" ? `Section ${i - 1}` : `第 ${i - 1} 部分`;\n  const bodyHeader = lang === \"en-US\" ? \"Key points\" : \"关键要点\";\n  slide.addText(sectionTitle, {\n    x: 0.6,\n    y: 0.4,\n    w: 12,\n    h: 0.8,\n    fontFace: \"Calibri\",\n    fontSize: 30,\n    bold: true,\n    color: \"111827\"\n  });\n  slide.addShape(pptx.ShapeType.roundRect, {\n    x: 0.65,\n    y: 1.35,\n    w: 0.28,\n    h: 0.28,\n    rectRadius: 0.05,\n    fill: { color: palette.accent },\n    line: { color: palette.accent, pt: 0 }\n  });\n  slide.addText(bodyHeader, {\n    x: 1.02,\n    y: 1.26,\n    w: 5,\n    h: 0.45,\n    fontFace: \"Calibri\",\n    fontSize: 16,\n    bold: true,\n    color: \"1F2937\"\n  });\n  const lines = lang === \"en-US\"\n    ? [`${sectionTitle} statement`, \"Evidence and explanation\", \"Action for next step\"]\n    : [`${sectionTitle} 结论陈述`, \"支撑证据与解释\", \"下一步行动建议\"];\n  slide.addText(lines.map((item) => ({ text: item, options: { bullet: { indent: 16 } } })), {\n    x: 1.02,\n    y: 1.85,\n    w: 11.4,\n    h: 3.8,\n    fontFace: \"Calibri\",\n    fontSize: 19,\n    color: \"111827\",\n    breakLine: true,\n    paraSpaceAfterPt: 14\n  });\n  slide.addText(`${i - 1}/${slideCount - 1}`, {\n    x: 11.2,\n    y: 6.85,\n    w: 2,\n    h: 0.3,\n    fontFace: \"Calibri\",\n    fontSize: 11,\n    color: \"6B7280\",\n    align: \"right\"\n  });\n}\n\nawait pptx.writeFile({ fileName: outAbs });\n\nconst binary = await fs.readFile(outAbs);\nconst checksum = createHash(\"sha256\").update(binary).digest(\"hex\");\nconst meta = {\n  skillId: \"openfoal-ppt-v1\",\n  engine: \"pptxgenjs\",\n  slideCount,\n  title,\n  outputPath: out,\n  checksum,\n  generatedAt: new Date().toISOString()\n};\nawait fs.writeFile(`${outAbs}.meta.json`, `${JSON.stringify(meta, null, 2)}\\n`, \"utf8\");\nconsole.log(JSON.stringify(meta));\n```\n\n## Error Handling\n\n- If `pptxgenjs` import fails, return explicit error: `MISSING_DEP:pptxgenjs`.\n- If args JSON is invalid, return: `INVALID_ARGS: expected JSON object`.\n- If `out` path escapes workspace, return: `INVALID_ARGS: out path escapes workspace`.\n\n## Final Response Format\n\nReturn concise plaintext:\n\n- `status: ok`\n- `out: <path>`\n- `slideCount: <n>`\n- `meta: <path>.meta.json`\n- `checksum: <sha256>`\n"
        }
      ]
    }
  ]
}
